<script>
    var  sirina = 400;
    var visina = 400;
    var grid = createArray(visina);
  
    var color = {
    1: '#FF0000',
    0: '#FFFFFF'
}

    for (var index = 0; index < 400; index++) {
        grid[index] = [];
    }
    var mirror_grid = createArray(visina);
    
    for (var j = 0; j < sirina; j++) { //first loop
        for (var k = 0; k < visina; k++) { //second loop
            var random_number = Math.random(); //generates random number
            var random_number_2  = (random_number * 2);
            var randomBinarniBr = Math.floor(random_number_2);
            if (randomBinarniBr === 1) {
                grid[j][k] = 1;
            } else {
                grid[j][k] = 0;
            }
        }
    }
    
    
    //functions 
    function windowGame() {
        //this is first part of function
        var canvas = document.getElementById("myCanvas");
        var ctx = canvas.getContext("2d");
        ctx.clearRect(0, 0, 400, 400);
        for (var j = 1; j < x; j++) { //first loop
            for (var k = 1; k < y; k++) { //second loop
              
               
                    ctx.fillStyle = color [grid[j][k]] ;
                    ctx.fillRect(j, k, 1, 1);
                
            }
        }
        //this is second part of the function
        windowAnimation();
        requestAnimationFrame(windowGame);
    }
    
    function createArray(rows) {
        var list = [];
        for (var i = 0; index < rows; index++) {
            list[index] = [];
        }
        return list;
    }
    
    function windowsAnimation() { //this is second part of the function
        for (var j = 1; j < sirina - 1; j++) { //first loop
            for (var k = 1; k < visina - 1; k++) { //second loop
                //apply the rules to each cell
                if (grid[j][k] === 0) {
                    switch (grid[j - 1][k - 1] + grid[j - 1][k] + grid[j - 1][k + 1] + grid[j][k - 1] + grid[j][k + 1] + grid[j + 1][k - 1] + grid[j + 1][k] + grid[j + 1][k + 1]) {
                        case 1:
                        case 2:
                            m[j][k] = 0; //sets the value to 0
                            break;
                        case 3:
                            m[j][k] = 1; //sets the value to 1
                            break;
                        case 4:
                            m[j][k] = 1;
                        case 5:
                            m[j][k] = !(m[j][k] | !m[j][k]);
                        default:
                            m[j][k] = 0; //sets the value to 0
                    }
                } else if (grid[j][k] === 1) {
                    switch (grid[j - 1][k - 1] + grid[j - 1][k] + grid[j - 1][k + 1] + grid[j][k - 1] + grid[j][k + 1] + grid[j + 1][k - 1] + grid[j + 1][k] + grid[j + 1][k + 1]) {
                        case 0:
                        case 1:
                            m[j][k] = (m[j][k] | !m[j][k]);
                            break;
                        case 2:
                            m[j][k] = (m[j][k] | !m[j][k]);
                        case 3:
                            m[j][k] = 1;
                            break;
                        case 4:
                        case 5:
                            m[j][k] = (m[j][k] & !m[j][k]);
                        case 6:
                        case 7:
                        case 8:
                            m[j][k] = 0;
                            break;
                        default:
                            m[j][k] = 0;
              
                    }
    
                }
            }
        }
    
        for (var j = 0; j < sirina; j++) {
            for (var k = 0; k < visina; k++) {
                grid[j][k] = m[j][k];
    
            }
        }
    
    
    }
    </script>
    <html>
        <body onload="f()">
            <canvas id="myCanvas" width="400" height="400"></canvas>
        </body>
    </html>